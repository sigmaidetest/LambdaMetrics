{"EDITOR_STATE":{"allProjectFiles":{"1dd6f83f-afee-4d46-a7d1-dd5991d45a29":{"id":"1dd6f83f-afee-4d46-a7d1-dd5991d45a29","parent":null,"name":"LambdaMetrics","type":"DIRECTORY","isDirectory":true,"children":["741e9b11-e4a3-4592-8587-8c6bbc8f4bdd","22a2fb65-ea84-4583-87c5-5d1041c9d3b0","583a3a0a-c206-492e-92c1-c82d677eaccb"],"isRemovable":false,"filePath":"LambdaMetrics"},"741e9b11-e4a3-4592-8587-8c6bbc8f4bdd":{"id":"741e9b11-e4a3-4592-8587-8c6bbc8f4bdd","parent":"1dd6f83f-afee-4d46-a7d1-dd5991d45a29","name":"lambda.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"LambdaMetrics/lambda.js","code":"let AWS = require('aws-sdk');\nconst sns = new AWS.SNS();\nconst lambda = new AWS.Lambda();\nconst cloudwatch = new AWS.CloudWatch();\n\nexports.handler = function (event, context, callback) {\n\n\n\t// var params = {\n\t// \tFunctionVersion: 'ALL',\n\t// \t// Marker: 'STRING_VALUE',\n\t// \t// MasterRegion: 'STRING_VALUE',\n\t// \tMaxItems: 100\n\t// };\n\t// lambda.listFunctions(params, function (err, data) {\n\t// \tif (err) { \n\t// \t\tconsole.log(err, err.stack);\n\t// \t\tcallback(err);\n\t// \t}\n\t// \telse {\n\t// \t\tconsole.log(data);\n\t// \t\tcallback(null, 'Successfully executed');\n\t// \t}\n\t// });\n\n\tvar params = {\n\t\tEndTime: 1526294898, /* required */\n\t\tMetricName: 'Duration', /* required */\n\t\tNamespace: 'AWS/Lambda', /* required */\n\t\tPeriod: 180, /* required */\n\t\tStartTime: 1526122095, /* required */\n\t\tDimensions: [\n\t\t\t{\n\t\t\t\tName: 'FunctionName', /* required */\n\t\t\t\tValue: 'SigmaTestEnvironmentRunner-andunranmal'\n\t\t\t},\n\t\t\t/* more items */\n\t\t],\n\t\t// ExtendedStatistics: [\n\t\t// \t'STRING_VALUE',\n\t\t// \t/* more items */\n\t\t// ],\n\t\tStatistics: ['Average', 'Minimum', 'Maximum'],\n\t\tUnit: 'Milliseconds'\n\t};\n\tcloudwatch.getMetricStatistics(params, function (err, data) {\n\t\tif (err) console.log(err, err.stack); // an error occurred\n\t\telse console.log(data);           // successful response\n\t});\n\n\t// var params = {\n\t// \tDimensions: [\n\t// \t\t{\n\t// \t\t\tName: 'FunctionName', /* required */\n\t// \t\t\tValue: 'SigmaTestEnvironmentRunner-andunranmal'\n\t// \t\t},\n\t// \t\t/* more items */\n\t// \t],\n\t// \tMetricName: 'Duration',\n\t// \tNamespace: 'AWS/Lambda',\n\t// \t// NextToken: 'STRING_VALUE'\n\t// };\n\t// cloudwatch.listMetrics(params, function (err, data) {\n\t// \tif (err) {\n\t// \t\tconsole.log(err, err.stack);\n\t// \t\tcallback(err);\n\t// \t}\n\t// \telse {\n\t// \t\tlet metrics = data.Metrics;\n\t// \t\tmetrics.forEach(metric => {\n\t// \t\t\tconsole.log(metric['MetricName']);\n\t// \t\t\tconsole.log(metric['Dimensions']);\n\t// \t\t});\n\t// \t\tcallback(null, 'Successfully executed');\n\t// \t}\n\t// });\n\n\n\n}","triggers":[],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"version":1,"syncVersion":157,"references":[],"testCases":{"71413f1a-6891-476e-9897-a2209e22c71b":{"id":"71413f1a-6891-476e-9897-a2209e22c71b","name":"Event 1","functionId":"741e9b11-e4a3-4592-8587-8c6bbc8f4bdd","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}}},"22a2fb65-ea84-4583-87c5-5d1041c9d3b0":{"id":"22a2fb65-ea84-4583-87c5-5d1041c9d3b0","parent":"1dd6f83f-afee-4d46-a7d1-dd5991d45a29","name":"LambdaInfoHandler.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"LambdaMetrics/LambdaInfoHandler.js","code":"const commonUtils = require('./CommonUtils');\nlet AWS = require('aws-sdk');\nconst lambda = new AWS.Lambda();\n\nconst LAMBDA_ARN_QPARAM = 'lambdaArn';\n\nexports.handler = function (event, context, callback) {\n\n\tlet qParams = event.queryStringParameters;\n\tlet qParamsKeys = Object.keys(qParams || {});\n\tconsole.log(qParamsKeys);\n\n\tif (qParamsKeys.indexOf(LAMBDA_ARN_QPARAM) >= 0) {\n\t\tgetLambdaInfo(callback, qParams[LAMBDA_ARN_QPARAM]);\n\t} else {\n\t\tlistLambdas(callback, qParams);\n\t}\n}\n\nfunction listLambdas(callback, qParams) {\n\n\tvar params = {\n\t\tFunctionVersion: 'ALL',\n\t\t// MasterRegion: 'STRING_VALUE',\n\t\tMaxItems: qParams.maxLimit\n\t};\n\tif (qParams.nextMarker) {\n\t\tparams['Marker'] = qParams.nextMarker;\n\t}\n\n\tlambda.listFunctions(params).promise()\n\t\t.then(data => {\n\t\t\tlet nextMarker = data.NextMarker;\n\t\t\tlet functions = data.Functions;\n\n\t\t\tlet summarizedFunctions = [];\n\t\t\tif (functions) {\n\t\t\t\tsummarizedFunctions = functions.map(func => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t\"FunctionName\": func.FunctionName,\n\t\t\t\t\t\t\"FunctionArn\": func.FunctionArn,\n\t\t\t\t\t\t\"Runtime\": func.Runtime,\n\t\t\t\t\t\t\"Description\": func.Description,\n\t\t\t\t\t\t\"Timeout\": func.Timeout,\n\t\t\t\t\t\t\"MemorySize\": func.MemorySize\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tcallback(null, commonUtils.generateSuccessResponse({\n\t\t\t\tNextMarker: nextMarker,\n\t\t\t\tFunctions: summarizedFunctions\n\t\t\t}));\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err, err.stack);\n\t\t\tcallback(null, commonUtils.generateFailureResponse(err));\n\t\t});\n}\n\nfunction getLambdaInfo(callback, lambdaArn) {\n\n\tvar params = {\n\t\tFunctionName: lambdaArn\n\t\t// Qualifier: 'STRING_VALUE'\n\t};\n\tlambda.getFunction(params).promise()\n\t\t.then(data => {\n\t\t\tconsole.log(data);\n\t\t\tcallback(null, commonUtils.generateSuccessResponse(data));\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.log(err, err.stack);\n\t\t\tcallback(null, commonUtils.generateFailureResponse(err));\n\t\t});\n};","triggers":[{"resourceName":"apigusEast1LambdaMetricsAPIfunctionsget","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"version":165,"syncVersion":430,"references":["583a3a0a-c206-492e-92c1-c82d677eaccb"],"testCases":{"06da86cf-d2a8-4150-b6b8-371af5ad3b9c":{"id":"06da86cf-d2a8-4150-b6b8-371af5ad3b9c","name":"Unnamed event","functionId":"22a2fb65-ea84-4583-87c5-5d1041c9d3b0","event":"{\n    \"key1\": \"value1\",\n    \"key2\": \"value2\",\n    \"key3\": \"value3\"\n}"}}},"583a3a0a-c206-492e-92c1-c82d677eaccb":{"id":"583a3a0a-c206-492e-92c1-c82d677eaccb","parent":"1dd6f83f-afee-4d46-a7d1-dd5991d45a29","name":"CommonUtils.js","type":"JS_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"LambdaMetrics/CommonUtils.js","code":"module.exports = {\n\n    generateResponse: function (payload, statusCode = 200, headers = {}) {\n        return generateGenericResponse(payload, statusCode, headers);\n    },\n\n    generateSuccessResponse: function (payload) {\n        return generateGenericResponse(payload, 200, { 'access-control-allow-origin': '*' });\n    },\n\n    generateFailureResponse: function (payload) {\n        return generateGenericResponse(payload, 500, { 'access-control-allow-origin': '*' });\n    }\n}\n\nfunction generateGenericResponse(payload, statusCode = 200, headers = {}) {\n    return {\n        \"isBase64Encoded\": 1,\n        \"statusCode\": statusCode,\n        \"headers\": headers,\n        \"body\": JSON.stringify(payload)\n    };\n}","triggers":[],"version":323,"syncVersion":139,"references":[]}},"rootNode":"1dd6f83f-afee-4d46-a7d1-dd5991d45a29","openFiles":["741e9b11-e4a3-4592-8587-8c6bbc8f4bdd","22a2fb65-ea84-4583-87c5-5d1041c9d3b0","583a3a0a-c206-492e-92c1-c82d677eaccb"],"currentFileId":"22a2fb65-ea84-4583-87c5-5d1041c9d3b0","resources":{"snsusEast1BatchProcessSNS":{"name":"snsusEast1BatchProcessSNS","type":"SNS","config":{"topicMode":1,"topicName":"BatchProcess_SNS","topicArn":"arn:aws:sns:us-east-1:318300609668:BatchProcess_SNS","topicRegion":"us-east-1","snsType":0,"subscriptions":[]},"globallyEditable":true},"apigusEast1LambdaMetricsAPIfunctionsget":{"name":"apigusEast1LambdaMetricsAPIfunctionsget","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"LambdaMetricsAPI","endpointType":"EDGE","resourceMode":0,"resourceName":"functions","resourcePath":"/functions","restMethod":"GET","proxyIntegration":true,"enableCORS":false,"stageMode":0,"stageName":"test"},"globallyEditable":true}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"editable":false}],"packageJSON":{"dependencies":{"aws-sdk":{"name":"aws-sdk","version":"2.176.0","notRemovable":true}}},"lambdaId":"741e9b11-e4a3-4592-8587-8c6bbc8f4bdd","additionalFiles":[]},"PROJECT_META":{"projectName":"LambdaMetrics","projectDescription":"","projectVersion":"1.0.0","projectRegion":"us-east-1","repoName":"LambdaMetrics","repoUrl":"https://github.com/sigmaidetest/LambdaMetrics","lastSave":1526362893965}}